#!/usr/bin/env python3
#
# epic distutils-cmake interface.
# the cmake config specifies python and
# native c python modules to export

from distutils.core import setup, Extension


pyext_cxxflags = ['-std=c++11', '-Wall', '-Wextra', '-pedantic']

py_modules = "${PY_MODULES}".split(";")

pyext_modules = {${PYEXT_SOURCEDEF}
}

pyext_extensions = list()
for modname, sources in pyext_modules.items():
    new_ext = Extension(
        name=modname,
        sources=['${CMAKE_SOURCE_DIR}/%s' % f for f in sources],
        extra_compile_args=pyext_cxxflags,
    )
    pyext_extensions.append(new_ext)


settings = {
    "name":        '${PROJECT_NAME}',
    "version":     '${PACKAGE_VERSION}',
    "description": '${PROJECT_NAME} python components',
    "author":      '[SFT]Tech',
    "url":         'http://${PROJECT_NAME}.sft.mx',
    "package_dir": {
        '': '${CMAKE_SOURCE_DIR}'
    },
    "packages":    py_modules,
    "ext_modules": pyext_extensions,
}

if __name__ == '__main__':
    setup(**settings)
